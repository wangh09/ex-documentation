## Basic instruments

* Mysql 、Redis 、Rocketmq
* Docker registry、Gitlab
* service images 
* Kubernetes secrets and persistent volume
* Kubernetes config yaml

---

## Simple Deployment Processure

1. Generate cold wallet data, refer this url  [http://gitlab.ziggurat.cn/ink-assets/devops-scripts/tree/master/gen-wallet/gen-hd-cold-wallet](http://gitlab.ziggurat.cn/ink-assets/devops-scripts/tree/master/gen-wallet/gen-hd-cold-wallet)
2. Keep config\_hd.js generated by above step. and import xpubkey.json data to database 
3. Create aws firewall for mysql and redis service
4. Create redis service from AWS ElastiCache. and no password for redis service.

5. Create rocketmq service

6. Create gitlab project and import configurations to git repo.

7. Prepare basic component need by kubernetes

   * Convert config\_hd.js to kubernete secret type. and import to images by volume method
   * Convert git username and password and others credentials to kubernetes secret

   * Create storageClass and persistent volume . persistenetVolume will be used by match module

8. Import related images to ECR \(AWS imgaes repository\)

9. Confiugre yaml files

10. Execute scripets and startup corresponding kubernete service

## Others

---

* Configure correct firewall rules for mysql and redis service before creating these service.
* A temporary centos pod can be used for create mysql database and other tests
* Copy files example: kubectl cp test.file centos-pod-name:/tmp   
* Enter pod container: kubectl exec -ti centos-pod-name  bash   



